<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synthient Proposals - Zeropoint Protocol</title>
    <meta name="description" content="CEO interface for reviewing and approving Synthient proposals">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://zeropoint-protocol.pages.dev/synthients/">
    <style>
      :root { --bg:#1e1e1e; --fg:#ffffff; --accent:#a855f7; --muted:#e0e0e0; }
      html,body{margin:0;padding:0;min-height:100%;background:var(--bg);color:var(--fg);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif}
      .container{max-width:1000px;margin:0 auto;padding:20px}
      h1{margin:0 0 20px 0;color:var(--accent)}
      h2{margin:20px 0 10px 0;color:var(--muted)}
      .status-panel{border:1px solid #333;border-radius:8px;padding:16px;margin:20px 0;background:#111}
      .proposal{border:1px solid #333;border-radius:8px;padding:16px;margin:16px 0;background:#111}
      .proposal h3{margin:0 0 8px 0;color:var(--accent)}
      .proposal-meta{font-size:0.9em;color:var(--muted);margin:8px 0}
      .proposal-summary{margin:12px 0;line-height:1.5}
      .feedback{width:100%;padding:8px;border:1px solid #444;border-radius:4px;background:#111;color:var(--fg);margin:8px 0}
      .btn{padding:8px 16px;border:1px solid var(--accent);border-radius:4px;background:transparent;color:var(--accent);cursor:pointer;margin:4px}
      .btn:hover{background:var(--accent);color:var(--bg)}
      .btn.approve{border-color:#4ade80;color:#4ade80}
      .btn.approve:hover{background:#4ade80;color:var(--bg)}
      .btn.veto{border-color:#f87171;color:#f87171}
      .btn.veto:hover{background:#f87171;color:var(--bg)}
      .loading{color:var(--muted);font-style:italic}
      .error{color:#f87171}
      .success{color:#4ade80}
    </style>
</head>
<body>
  <div class="container">
    <h1>Synthient Proposals</h1>
    
    <div class="status-panel">
      <h2>Training Status</h2>
      <div id="status-content" class="loading">Loading status...</div>
    </div>
    
    <div id="proposals-container">
      <div class="loading">Loading proposals...</div>
    </div>
  </div>

  <script>
    let proposals = [];
    let status = null;
    let feedback = {};

    async function loadStatus() {
      try {
        const response = await fetch('/api/synthient/status');
        status = await response.json();
        
        const statusContent = document.getElementById('status-content');
        statusContent.innerHTML = `
          <div><strong>Summary:</strong> ${status.summary || 'Unknown'}</div>
          <div><strong>Services:</strong></div>
          <pre style="font-size:0.8em;margin:8px 0;overflow:auto">${JSON.stringify(status.services, null, 2)}</pre>
        `;
      } catch (error) {
        document.getElementById('status-content').innerHTML = `<div class="error">Error loading status: ${error.message}</div>`;
      }
    }

    async function loadProposals() {
      try {
        const response = await fetch('/api/synthient/proposals');
        const data = await response.json();
        proposals = data.items || [];
        renderProposals();
      } catch (error) {
        document.getElementById('proposals-container').innerHTML = `<div class="error">Error loading proposals: ${error.message}</div>`;
      }
    }

    function renderProposals() {
      const container = document.getElementById('proposals-container');
      if (proposals.length === 0) {
        container.innerHTML = '<div class="loading">No proposals available</div>';
        return;
      }

      container.innerHTML = proposals.map(proposal => `
        <div class="proposal">
          <h3>${proposal.title}</h3>
          <div class="proposal-meta">
            Owner: ${proposal.owner} • 
            Created: ${new Date(proposal.created_at).toLocaleString()} • 
            Priority: ${proposal.priority}
          </div>
          <div class="proposal-summary">${proposal.summary}</div>
          <textarea 
            class="feedback" 
            placeholder="CEO feedback (optional)"
            onchange="feedback['${proposal.id}'] = this.value"
          >${feedback[proposal.id] || ''}</textarea>
          <div>
            <button class="btn approve" onclick="decide('${proposal.id}', 'approve')">Approve</button>
            <button class="btn veto" onclick="decide('${proposal.id}', 'veto')">Veto</button>
          </div>
        </div>
      `).join('');
    }

    async function decide(proposalId, action) {
      try {
        const response = await fetch('/api/synthient/consensus', {
          method: 'POST',
          headers: { 'content-type': 'application/json' },
          body: JSON.stringify({
            id: proposalId,
            action: action,
            feedback: feedback[proposalId] || '',
            actor: 'CEO'
          })
        });
        
        if (response.ok) {
          alert(`${action.toUpperCase()} recorded successfully`);
          // Reload proposals to show updated status
          loadProposals();
        } else {
          alert(`Failed to record ${action}`);
        }
      } catch (error) {
        alert(`Error: ${error.message}`);
      }
    }

    // Load data on page load
    loadStatus();
    loadProposals();
  </script>
</body>
</html>
