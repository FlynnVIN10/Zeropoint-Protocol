name: License & CLA Check

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]
  workflow_dispatch:

jobs:
  license-check:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Check license file exists
        run: |
          if [ -f "LICENSE.md" ] || [ -f "LICENSE" ]; then
            echo "License file found"
            ls -la LICENSE*
          else
            echo "No license file found"
            exit 1
          fi
          
      - name: Check CLA file exists
        run: |
          if [ -f "CLA.md" ]; then
            echo "CLA file found"
            cat CLA.md | head -10
          else
            echo "No CLA file found"
            exit 1
          fi
          
      - name: Validate license format
        run: |
          if [ -f "LICENSE.md" ]; then
            echo "Checking LICENSE.md format..."
            head -5 LICENSE.md
          elif [ -f "LICENSE" ]; then
            echo "Checking LICENSE format..."
            head -5 LICENSE
          fi
          
  legal-compliance:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Check legal documentation
        run: |
          echo "Checking legal documentation..."
          if [ -d "docs/legal" ]; then
            echo "Legal docs directory found:"
            ls -la docs/legal/
          fi
          
          if [ -f "LEGAL.md" ]; then
            echo "LEGAL.md found"
          fi
          
      - name: Check compliance files
        run: |
          echo "Checking compliance files..."
          if [ -d "docs/compliance" ]; then
            echo "Compliance docs found:"
            ls -la docs/compliance/
          fi
