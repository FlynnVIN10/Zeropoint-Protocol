import{v as e,b as a,i as t,j as n}from"./server.mjs";const r={trailing:!0};function debounce(e,a=25,t={}){if(t={...r,...t},!Number.isFinite(a))throw new TypeError("Expected `wait` to be a finite number");let n,l,s,u,o=[];const applyFn=(a,n)=>(s=async function(e,a,t){return await e.apply(a,t)}(e,a,n),s.finally(()=>{if(s=null,t.trailing&&u&&!l){const e=applyFn(a,u);return u=null,e}}),s);return function(...e){return s?(t.trailing&&(u=e),s):new Promise(r=>{const s=!l&&t.leading;clearTimeout(l),l=setTimeout(()=>{l=null;const a=t.leading?n:applyFn(this,e);for(const e of o)e(a);o=[]},a),s?(n=applyFn(this,e),r(n)):o.push(r)})}}e.defineComponent({name:"ServerPlaceholder",render:()=>e.createElementBlock("div")});const l=Symbol.for("nuxt:client-only");e.defineComponent({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(a,{slots:t,attrs:n}){const r=e.shallowRef(!1),s=e.getCurrentInstance();return s&&(s._nuxtClientOnly=!0),e.provide(l,!0),()=>{var l;if(r.value){const a=null==(l=t.default)?void 0:l.call(t);return a&&1===a.length?[e.cloneVNode(a[0],n)]:a}const s=t.fallback||t.placeholder;if(s)return e.h(s);const u=a.fallback||a.placeholder||"",o=a.fallbackTag||a.placeholderTag||"span";return e.createElementBlock(o,n,u)}}});function useAsyncData(...r){var l;const s="string"==typeof r[r.length-1]?r.pop():void 0;(function(e,a){if("string"==typeof e)return!1;if("object"==typeof e&&null!==e)return!1;if("function"==typeof e&&"function"==typeof a)return!1;return!0})(r[0],r[1])&&r.unshift(s);let[u,o,c={}]=r;const i=e.computed(()=>e.toValue(u));if("string"!=typeof i.value)throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if("function"!=typeof o)throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const d=a();null!=c.server||(c.server=!0),null!=c.default||(c.default=getDefault),null!=c.getCachedData||(c.getCachedData=getDefaultCachedData),null!=c.lazy||(c.lazy=!1),null!=c.immediate||(c.immediate=!0),null!=c.deep||(c.deep=t.deep),null!=c.dedupe||(c.dedupe="cancel"),c._functionName,d._asyncData[i.value];const f={cause:"initial",dedupe:c.dedupe};(null==(l=d._asyncData[i.value])?void 0:l._init)||(f.cachedData=c.getCachedData(i.value,d,{cause:"initial"}),d._asyncData[i.value]=function(a,r,l,s,u){var o;null!=(o=a.payload._errors)[r]||(o[r]=t.errorValue);const c=s.getCachedData!==getDefaultCachedData,i=l,d=s.deep?e.ref:e.shallowRef,f=null!=u,y=a.hook("app:data:refresh",async e=>{e&&!e.includes(r)||await v.execute({cause:"refresh:hook"})}),v={data:d(f?u:s.default()),pending:e.shallowRef(!f),error:e.toRef(a.payload._errors,r),status:e.shallowRef("idle"),execute:(...l)=>{var u,o;const[c,d]=l,f=c&&void 0===d&&"object"==typeof c?c:{};if(a._asyncDataPromises[r]){if("defer"===(y=null!=(u=f.dedupe)?u:s.dedupe)||!1===y)return a._asyncDataPromises[r];a._asyncDataPromises[r].cancelled=!0}var y;if("initial"===f.cause||a.isHydrating){const e="cachedData"in f?f.cachedData:s.getCachedData(r,a,{cause:null!=(o=f.cause)?o:"refresh:manual"});if(null!=e)return a.payload.data[r]=v.data.value=e,v.error.value=t.errorValue,v.status.value="success",Promise.resolve(e)}v.pending.value=!0,v.status.value="pending";const p=new Promise((e,t)=>{try{e(i(a))}catch(e){t(e)}}).then(async e=>{if(p.cancelled)return a._asyncDataPromises[r];let n=e;s.transform&&(n=await s.transform(e)),s.pick&&(n=function(e,a){const t={};for(const n of a)t[n]=e[n];return t}(n,s.pick)),a.payload.data[r]=n,v.data.value=n,v.error.value=t.errorValue,v.status.value="success"}).catch(t=>{if(p.cancelled)return a._asyncDataPromises[r];v.error.value=n(t),v.data.value=e.unref(s.default()),v.status.value="error"}).finally(()=>{p.cancelled||(v.pending.value=!1,delete a._asyncDataPromises[r])});return a._asyncDataPromises[r]=p,a._asyncDataPromises[r]},_execute:debounce((...e)=>v.execute(...e),0,{leading:!0}),_default:s.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{var n;y(),(null==(n=a._asyncData[r])?void 0:n._init)&&(a._asyncData[r]._init=!1),c||e.nextTick(()=>{var e;(null==(e=a._asyncData[r])?void 0:e._init)||(clearNuxtDataByKey(a,r),v.execute=()=>Promise.resolve(),v.data.value=t.value)})}};return v}(d,i.value,o,c,f.cachedData));d._asyncData[i.value]._deps++;if(!1!==c.server&&d.payload.serverRendered&&c.immediate){const a=d._asyncData[i.value].execute(f);e.getCurrentInstance()?e.onServerPrefetch(()=>a):d.hook("app:created",async()=>{await a})}const y={data:writableComputedRef(()=>{var e;return null==(e=d._asyncData[i.value])?void 0:e.data}),pending:writableComputedRef(()=>{var e;return null==(e=d._asyncData[i.value])?void 0:e.pending}),status:writableComputedRef(()=>{var e;return null==(e=d._asyncData[i.value])?void 0:e.status}),error:writableComputedRef(()=>{var e;return null==(e=d._asyncData[i.value])?void 0:e.error}),refresh:(...e)=>d._asyncData[i.value].execute(...e),execute:(...e)=>d._asyncData[i.value].execute(...e),clear:()=>clearNuxtDataByKey(d,i.value)},v=Promise.resolve(d._asyncDataPromises[i.value]).then(()=>y);return Object.assign(v,y),v}function writableComputedRef(a){return e.computed({get(){var e;return null==(e=a())?void 0:e.value},set(e){const t=a();t&&(t.value=e)}})}function clearNuxtDataByKey(e,a){a in e.payload.data&&(e.payload.data[a]=void 0),a in e.payload._errors&&(e.payload._errors[a]=t.errorValue),e._asyncData[a]&&(e._asyncData[a].data.value=void 0,e._asyncData[a].error.value=t.errorValue,e._asyncData[a].pending.value=!1,e._asyncData[a].status.value="idle"),a in e._asyncDataPromises&&(e._asyncDataPromises[a]&&(e._asyncDataPromises[a].cancelled=!0),e._asyncDataPromises[a]=void 0)}const getDefault=()=>t.value,getDefaultCachedData=(e,a,t)=>a.isHydrating?a.payload.data[e]:"refresh:manual"!==t.cause&&"refresh:hook"!==t.cause?a.static.data[e]:void 0;export{useAsyncData as u};
//# sourceMappingURL=asyncData-DoT6D3uG.mjs.map
